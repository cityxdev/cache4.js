$(function(){"use strict";void 0===window.cache4js&&(window.cache4js=function(){const e=(o=navigator.userAgent,n=o.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(n[1])?"IE "+((t=/\brv[ :]+(\d+)/g.exec(o)||[])[1]||""):"Chrome"===n[1]&&null!=(t=o.match(/\b(OPR|Edge)\/(\d+)/))?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=o.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n.join(" ")));var t,o,n;e.indexOf("Opera"),e.indexOf("Firefox"),e.indexOf("Safari"),e.indexOf("Chrome");const c=0===e.indexOf("IE"),s=0===e.indexOf("Edge");var a={CACHE_NAMESPACE:"__CACHE4JS__"};const r=!s&&!c&&"undefined"!=typeof LZString;var i=void 0;function l(e){return a.CACHE_NAMESPACE+btoa(e)}function u(e){try{return e?JSON.parse(r?LZString.decompress(e):e):void 0}catch(e){return void console.log(e)}}a.setMaxElements=function(e){localStorage.setItem("maxElements"+a.CACHE_NAMESPACE,e.toString()),a.getSize()>e&&setTimeout(a.clearExpiredCaches,10)},a.getMaxElements=function(){const e=localStorage.getItem("maxElements"+a.CACHE_NAMESPACE);return e?parseInt(e):void 0},a.getSize=function(){return i},a.loadCache=function(e,t){function o(t){const o=t.getItem(l(e)),n=u(o),c=n&&n.expireSecs&&Date.now()-1e3*n.expireSecs>n.millis;return(o&&!n||c)&&a.removeCache(e),n&&!c?n.value:void 0}let n=o(localStorage);return n||(n=o(sessionStorage)),n||t},a.getCache=function(e,t,o){const n=a.loadCache(e,void 0);return null==n?a.storeCache(e,t(),o):n},a.storeCache=function(e,t,o){i>=a.getMaxElements()&&a.clearExpiredCaches();const n=l(e),c=sessionStorage[n],s=localStorage[n],u=c||s;if(i>=a.getMaxElements()&&!u)return console.log(a.CACHE_NAMESPACE+" Cache is full. Size: "+i+", max elements: "+a.getMaxElements()),t;if(null!=t){const e=null==o||o<=0||o>300,l=e?localStorage:sessionStorage;e&&c&&sessionStorage.removeItem(n),!e&&s&&localStorage.removeItem(n);let m={value:t,millis:Date.now(),expireSecs:o};const h=(C=m,r?LZString.compress(JSON.stringify(C)):JSON.stringify(C));try{l.setItem(n,h),u||i++,setTimeout(a.clearExpiredCaches,100)}catch(e){console.log(a.CACHE_NAMESPACE+" Error storing cache (1)"),a.clearExpiredCaches();try{l.setItem(n,h),u||i++}catch(e){console.log(a.CACHE_NAMESPACE+" Error storing cache (2)"),console.log(e)}}}var C;return t},a.removeCache=function(e){const t=l(e);localStorage[t]?(localStorage.removeItem(t),i--):sessionStorage[t]&&(sessionStorage.removeItem(t),i--)},a.clearCaches=function(){function e(e){$.each(e,function(t,o){0===t.indexOf(a.CACHE_NAMESPACE)&&(e.removeItem(t),i--)})}e(localStorage),e(sessionStorage)},a.clearExpiredCaches=function(){let e=0;function t(t){t=t||localStorage,$.each(t,function(o,n){if(0===o.indexOf(a.CACHE_NAMESPACE)){const c=u(n),s=c&&c.expireSecs&&Date.now()-1e3*c.expireSecs>c.millis;(n&&!c||s)&&(t.removeItem(o),i--,e++)}})}t(localStorage),t(sessionStorage),e>0&&console.log(a.CACHE_NAMESPACE+" Cleared "+e+" expired caches")},a.ajaxCache=function(e,t){return new C(e,t)};const C=function(e,t){let o=this;if(this._data=void 0,(!e.method||"get"!==e.method.toLowerCase()||"head"!==e.method.toLowerCase())&&e.url){const n=e.url+(e.headers&&Object.keys(e.headers)>0?JSON.stringify(e.headers):"")+(e.data?JSON.stringify(e.data):""),c=a.loadCache(n,void 0);if(e.context)for(let t in e.context)this[t]=e.context[t];if(null!=c)return o._data=c,e.success&&(this.mySucess=e.success,this.mySucess(c)),e.complete&&(this.myComplete=e.complete,this.myComplete(this,"CACHE")),o.done=function(e){const t=Array.isArray(e)?e:[e];for(let e in t)o._tempCallback=t[e],o._tempCallback(o._data);return o},o.always=o.done,o.fail=function(){},o.then=function(e){return o._tempCallback=e,o._tempCallback(o._data),o},this;{let o=e.success;e.context=e.context?e.context:{},e.context.cacheSuccess=o,e.context.cacheKey=n,e.context.expireSecs=t,e.success=function(e,t,o){a.storeCache(this.cacheKey,e,this.expireSecs),this.cacheSuccess&&this.cacheSuccess(e,t,o)}}}return $.ajax(e)};if(a.getMaxElements()||a.setMaxElements(150),void 0===i){i=0;const e=function(e){$.each(e,function(e,t){0===e.indexOf(a.CACHE_NAMESPACE)&&i++})};e(localStorage),e(sessionStorage)}return a}())});
